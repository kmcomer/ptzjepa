OK
INFO:HANWHA_camera:camera_command({'msubmenu': 'query', 'action': 'view', 'Query': 'Pan,Tilt,Zoom'})
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): 130.202.23.92:80
DEBUG:urllib3.connectionpool:http://130.202.23.92:80 "GET /stw-cgi/ptzcontrol.cgi?msubmenu=query&action=view&Query=Pan%2CTilt%2CZoom HTTP/1.1" 401 347
DEBUG:urllib3.connectionpool:http://130.202.23.92:80 "GET /stw-cgi/ptzcontrol.cgi?msubmenu=query&action=view&Query=Pan%2CTilt%2CZoom HTTP/1.1" 200 142
INFO:HANWHA_camera:camera_command({'msubmenu': 'query', 'action': 'view', 'Query': 'Pan,Tilt,Zoom'})
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): 130.202.23.92:80
DEBUG:urllib3.connectionpool:http://130.202.23.92:80 "GET /stw-cgi/ptzcontrol.cgi?msubmenu=query&action=view&Query=Pan%2CTilt%2CZoom HTTP/1.1" 401 347
DEBUG:urllib3.connectionpool:http://130.202.23.92:80 "GET /stw-cgi/ptzcontrol.cgi?msubmenu=query&action=view&Query=Pan%2CTilt%2CZoom HTTP/1.1" 200 142
INFO:HANWHA_camera:camera_command({'msubmenu': 'query', 'action': 'view', 'Query': 'Pan,Tilt,Zoom'})
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): 130.202.23.92:80
DEBUG:urllib3.connectionpool:http://130.202.23.92:80 "GET /stw-cgi/ptzcontrol.cgi?msubmenu=query&action=view&Query=Pan%2CTilt%2CZoom HTTP/1.1" 401 347
DEBUG:urllib3.connectionpool:http://130.202.23.92:80 "GET /stw-cgi/ptzcontrol.cgi?msubmenu=query&action=view&Query=Pan%2CTilt%2CZoom HTTP/1.1" 200 142
INFO:HANWHA_camera:camera_command({'msubmenu': 'query', 'action': 'view', 'Query': 'Pan,Tilt,Zoom'})
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): 130.202.23.92:80
DEBUG:urllib3.connectionpool:http://130.202.23.92:80 "GET /stw-cgi/ptzcontrol.cgi?msubmenu=query&action=view&Query=Pan%2CTilt%2CZoom HTTP/1.1" 401 347
DEBUG:urllib3.connectionpool:http://130.202.23.92:80 "GET /stw-cgi/ptzcontrol.cgi?msubmenu=query&action=view&Query=Pan%2CTilt%2CZoom HTTP/1.1" 200 142
INFO:HANWHA_camera:camera_command({'msubmenu': 'query', 'action': 'view', 'Query': 'Pan,Tilt,Zoom'})
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): 130.202.23.92:80
DEBUG:urllib3.connectionpool:http://130.202.23.92:80 "GET /stw-cgi/ptzcontrol.cgi?msubmenu=query&action=view&Query=Pan%2CTilt%2CZoom HTTP/1.1" 401 347
DEBUG:urllib3.connectionpool:http://130.202.23.92:80 "GET /stw-cgi/ptzcontrol.cgi?msubmenu=query&action=view&Query=Pan%2CTilt%2CZoom HTTP/1.1" 200 140
INFO:HANWHA_camera:camera_command({'msubmenu': 'query', 'action': 'view', 'Query': 'Pan,Tilt,Zoom'})
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): 130.202.23.92:80
DEBUG:urllib3.connectionpool:http://130.202.23.92:80 "GET /stw-cgi/ptzcontrol.cgi?msubmenu=query&action=view&Query=Pan%2CTilt%2CZoom HTTP/1.1" 401 347
DEBUG:urllib3.connectionpool:http://130.202.23.92:80 "GET /stw-cgi/ptzcontrol.cgi?msubmenu=query&action=view&Query=Pan%2CTilt%2CZoom HTTP/1.1" 200 140
INFO:HANWHA_camera:camera_command({'msubmenu': 'query', 'action': 'view', 'Query': 'Pan,Tilt,Zoom'})
DEBUG:urllib3.connectionpool:Starting new HTTP connection (1): 130.202.23.92:80
DEBUG:urllib3.connectionpool:http://130.202.23.92:80 "GET /stw-cgi/ptzcontrol.cgi?msubmenu=query&action=view&Query=Pan%2CTilt%2CZoom HTTP/1.1" 401 347
DEBUG:urllib3.connectionpool:http://130.202.23.92:80 "GET /stw-cgi/ptzcontrol.cgi?msubmenu=query&action=view&Query=Pan%2CTilt%2CZoom HTTP/1.1" 200 134
INFO:HANWHA_camera:Finished
INFO:HANWHA_camera:elapsed_time: 1.7810702323913574
INFO:source.prepare_dataset:Number of labels: 420
INFO:source.run_jepa:called-params ./configs/Config_file.yaml
INFO:source.run_jepa:loading params...
INFO:source.run_jepa:loaded params...
Starting mount process...
Checking SSH connection...
Executing command: ssh -i /root/.ssh/id_rsa -o StrictHostKeyChecking=no waggle@130.202.23.67 echo SSH connection successful
STDOUT: SSH connection successful

STDERR: Warning: Permanently added '130.202.23.67' (ECDSA) to the list of known hosts.

Checking SFTP connection...
Executing command: sftp -o IdentityFile=/root/.ssh/id_rsa -o StrictHostKeyChecking=no waggle@130.202.23.67:/
STDOUT: Changing to: /

STDERR: Connected to 130.202.23.67.

Checking FUSE availability...
Executing command: fusermount -V
STDOUT: fusermount3 version: 3.10.3

STDERR: 
Checking sshfs availability...
Executing command: sshfs -V
STDOUT: fusermount3 version: 3.10.3
SSHFS version 3.7.1
FUSE library version 3.10.3
using FUSE kernel interface version 7.31

STDERR: 
Executing sshfs mount command in background...
Mount verified successfully.
Mount verified successfully.
Mounted successfully!
{   'action': {   'jump': {   'down': [0.0, -3.0, 0.0],
                              'left': [-5.0, 0.0, 0.0],
                              'right': [5.0, 0.0, 0.0],
                              'up': [0.0, 3.0, 0.0]},
                  'long': {   'down': [0.0, -1.0, 0.0],
                              'left': [-1.0, 0.0, 0.0],
                              'right': [1.0, 0.0, 0.0],
                              'up': [0.0, 1.0, 0.0],
                              'zoom_in': [0.0, 0.0, 0.2],
                              'zoom_out': [0.0, 0.0, -0.2]},
                  'noop': [0.0, 0.0, 0.0],
                  'short': {   'down': [0.0, -0.1, 0.0],
                               'left': [-0.1, 0.0, 0.0],
                               'left_down': [-0.1, -0.1, 0.0],
                               'left_up': [-0.1, 0.1, 0.0],
                               'right': [0.1, 0.0, 0.0],
                               'right_down': [0.1, -0.1, 0.0],
                               'right_up': [0.1, 0.1, 0.0],
                               'up': [0.0, 0.1, 0.0],
                               'zoom_in': [0.0, 0.0, 0.1],
                               'zoom_out': [0.0, 0.0, -0.1]}},
    'data': {   'batch_size': 4,
                'color_jitter_strength': 0.0,
                'crop_scale': [0.98, 1.0],
                'crop_size': 224,
                'global_batch_size': 32,
                'image_folder': 'imagenet_full_size/061417/',
                'num_workers': 10,
                'pin_mem': True,
                'rl_batch_size': 64,
                'root_path': '$replace_this_with_absolute_path_to_your_datasets_directory',
                'use_color_distortion': False,
                'use_gaussian_blur': False,
                'use_horizontal_flip': False},
    'deployment': {   'camera': {   'brand': 0,
                                    'ip': '130.202.23.92',
                                    'password': 'Why1Not@',
                                    'username': 'dario'},
                      'distributed': {   'directory': '/home/waggle/world_models',
                                         'enabled': True,
                                         'ip': '130.202.23.67',
                                         'username': 'waggle'},
                      'docker': {   'app_path': '/home/waggle/dario/ptzjepa',
                                    'image': 'dariodematties/ptzjepa:latest',
                                    'log_path': '/home/waggle/dario/log.out',
                                    'persistence_path': '/home/waggle/dario/JEPA_Persistence'},
                      'operation': {   'debug': True,
                                       'iterations': 20,
                                       'keep_images': True,
                                       'movements': 20,
                                       'run_mode': 'lifelong',
                                       'track_all': True,
                                       'track_positions': True}},
    'dreamer': {'dream_length': 10, 'number_of_dreams': 20},
    'logging': {   'agent_folder': '/persistence/agents/',
                   'dream_folder': '/persistence/dreams/',
                   'folder': '/persistence/world_models/',
                   'ownership_folder': '/persistence',
                   'write_tag': 'jepa'},
    'mask': {   'allow_overlap': False,
                'aspect_ratio': [0.75, 1.5],
                'enc_mask_scale': [0.85, 1.0],
                'min_keep': 10,
                'num_enc_masks': 1,
                'num_pred_masks': 4,
                'patch_size': 14,
                'pred_mask_scale': [0.15, 0.2]},
    'memory': {'dreams': 50, 'memory_models': 10, 'models': 5, 'rl_models': 5},
    'meta': {   'agent_model_arch': 'vit_tiny',
                'camera_brand': 0,
                'copy_data': False,
                'distributed': True,
                'load_checkpoint': True,
                'model_arch': 'vit_tiny',
                'pred_depth': 12,
                'pred_emb_dim': 384,
                'read_checkpoint': None,
                'use_bfloat16': True},
    'optimization': {   'TAU': 0.0005,
                        'ema': [0.85, 1.0],
                        'epochs': 100,
                        'final_lr': 1e-06,
                        'final_weight_decay': 0.4,
                        'ipe_scale': 1.0,
                        'lr': 0.0001,
                        'rl_ema': [0.0005, 5e-05],
                        'rl_epochs': 100,
                        'rl_final_lr': 1e-06,
                        'rl_lr': 0.0001,
                        'rl_start_lr': 2e-06,
                        'rl_warmup': 5,
                        'start_lr': 2e-06,
                        'warmup': 5,
                        'weight_decay': 0.04},
    'plateau': {   'patience': 10,
                   'rl_patience': 10,
                   'rl_threshold': 0.01,
                   'threshold': 0.01,
                   'wm_patience': 10,
                   'wm_threshold': 0.01},
    'redis': {   'host': '130.202.23.67',
                 'locker_expiration': 36000,
                 'password': 'your_strong_password',
                 'port': 6379}}
locker_system  <source.utils.redis_cli.MultiLockerSystem object at 0x7f6b282ec160>
acquired_locker  None
model_id  3
acquired_locker  3
Process 1 acquired locker 3
Traceback (most recent call last):
  File "/app/main.py", line 250, in <module>
    main()
  File "/app/main.py", line 238, in main
    lifelong_learning(args)
  File "/app/main.py", line 62, in lifelong_learning
    training_complete = run_jepa(arguments.fname, "world_model")
  File "/app/source/run_jepa.py", line 1391, in run
    return world_model(params)
  File "/app/source/run_jepa.py", line 582, in world_model
    assert parent_model_name.split("_")[0] == "ag", "World model's parent must be an agent model except the Adam model"
AssertionError: World model's parent must be an agent model except the Adam model
