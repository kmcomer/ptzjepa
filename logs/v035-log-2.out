INFO:source.run_rl:[41,     0] loss: 0.000 [wd: 1.65e-01] [lr: 7.02e-05] [mem: 6.21e+03] (1023.7 ms)
INFO:source.run_rl:[41,     0] grad_stats: [8.65e-04 8.82e-04] (8.00e-04, 5.17e-02)
INFO:source.run_rl:avg. loss 0.000
INFO:source.run_rl:Epoch 42
INFO:source.run_rl:[42,     0] loss: 0.000 [wd: 1.70e-01] [lr: 6.87e-05] [mem: 6.21e+03] (1035.2 ms)
INFO:source.run_rl:[42,     0] grad_stats: [1.08e-03 1.07e-03] (1.03e-03, 5.87e-02)
INFO:source.run_rl:avg. loss 0.000
INFO:source.run_rl:Epoch 43
INFO:source.run_rl:[43,     0] loss: 0.000 [wd: 1.76e-01] [lr: 6.72e-05] [mem: 6.21e+03] (999.1 ms)
INFO:source.run_rl:[43,     0] grad_stats: [1.24e-03 1.28e-03] (1.19e-03, 6.93e-02)
INFO:source.run_rl:avg. loss 0.000
INFO:source.run_rl:Epoch 44
INFO:source.run_rl:[44,     0] loss: 0.000 [wd: 1.81e-01] [lr: 6.56e-05] [mem: 6.21e+03] (1017.2 ms)
INFO:source.run_rl:[44,     0] grad_stats: [7.77e-04 8.40e-04] (7.74e-04, 4.83e-02)
INFO:source.run_rl:avg. loss 0.000
INFO:source.track_progress:Saving ag_00_04 to /persistence/agents/ag_00_04/model_info.yaml
INFO:source.env_interaction:called-params ./configs/Config_file.yaml
INFO:source.env_interaction:loading params...
INFO:source.env_interaction:loaded params...
Process 1 acquired locker 4
wm_candid  ['wm_00_04', 'wm_00_01', 'wm_00_02', 'wm_00_03', 'wm_00_00']
model_name  wm_00_04
type(model_name)  <class 'str'>
log_file  /persistence/world_models/wm_00_04/jepa.csv
save_path  /persistence/world_models/wm_00_04/jepa-ep{epoch}.pt
latest_path  /persistence/world_models/wm_00_04/jepa-latest.pt
load_path  /persistence/world_models/wm_00_04/jepa-latest.pt
Process 1 released locker 4
{   'action': {   'jump': {   'down': [0.0, -3.0, 0.0],
                              'left': [-5.0, 0.0, 0.0],
                              'right': [5.0, 0.0, 0.0],
                              'up': [0.0, 3.0, 0.0]},
                  'long': {   'down': [0.0, -1.0, 0.0],
                              'left': [-1.0, 0.0, 0.0],
                              'right': [1.0, 0.0, 0.0],
                              'up': [0.0, 1.0, 0.0],
                              'zoom_in': [0.0, 0.0, 0.2],
                              'zoom_out': [0.0, 0.0, -0.2]},
                  'noop': [0.0, 0.0, 0.0],
                  'short': {   'down': [0.0, -0.1, 0.0],
                               'left': [-0.1, 0.0, 0.0],
                               'left_down': [-0.1, -0.1, 0.0],
                               'left_up': [-0.1, 0.1, 0.0],
                               'right': [0.1, 0.0, 0.0],
                               'right_down': [0.1, -0.1, 0.0],
                               'right_up': [0.1, 0.1, 0.0],
                               'up': [0.0, 0.1, 0.0],
                               'zoom_in': [0.0, 0.0, 0.1],
                               'zoom_out': [0.0, 0.0, -0.1]}},
    'data': {   'batch_size': 4,
                'color_jitter_strength': 0.0,
                'crop_scale': [0.98, 1.0],
                'crop_size': 224,
                'global_batch_size': 32,
                'image_folder': 'imagenet_full_size/061417/',
                'num_workers': 10,
                'pin_mem': True,
                'rl_batch_size': 64,
                'root_path': '$replace_this_with_absolute_path_to_your_datasets_directory',
                'use_color_distortion': False,
                'use_gaussian_blur': False,
                'use_horizontal_flip': False},
    'deployment': {   'camera': {   'brand': 1,
                                    'ip': '130.202.23.91',
                                    'password': '0Bscura#',
                                    'username': 'camera'},
                      'distributed': {   'directory': '/home/waggle/world_models',
                                         'enabled': True,
                                         'ip': '130.202.23.67',
                                         'username': 'waggle'},
                      'docker': {   'app_path': '/home/waggle/dario/ptzjepa',
                                    'image': 'dariodematties/ptzjepa:latest',
                                    'log_path': '/home/waggle/dario/log.out',
                                    'persistence_path': '/home/waggle/dario/JEPA_Persistence'},
                      'operation': {   'debug': True,
                                       'iterations': 20,
                                       'keep_images': True,
                                       'movements': 20,
                                       'run_mode': 'lifelong',
                                       'track_all': True,
                                       'track_positions': True}},
    'dreamer': {'dream_length': 10, 'number_of_dreams': 20},
    'logging': {   'agent_folder': '/persistence/agents/',
                   'dream_folder': '/persistence/dreams/',
                   'folder': '/persistence/world_models/',
                   'ownership_folder': '/persistence',
                   'write_tag': 'jepa'},
    'mask': {   'allow_overlap': False,
                'aspect_ratio': [0.75, 1.5],
                'enc_mask_scale': [0.85, 1.0],
                'min_keep': 10,
                'num_enc_masks': 1,
                'num_pred_masks': 4,
                'patch_size': 14,
                'pred_mask_scale': [0.15, 0.2]},
    'memory': {'dreams': 50, 'memory_models': 10, 'models': 5, 'rl_models': 5},
    'meta': {   'agent_model_arch': 'vit_tiny',
                'camera_brand': 0,
                'copy_data': False,
                'distributed': True,
                'load_checkpoint': True,
                'model_arch': 'vit_tiny',
                'pred_depth': 12,
                'pred_emb_dim': 384,
                'read_checkpoint': None,
                'use_bfloat16': True},
    'optimization': {   'TAU': 0.0005,
                        'ema': [0.85, 1.0],
                        'epochs': 100,
                        'final_lr': 1e-06,
                        'final_weight_decay': 0.4,
                        'ipe_scale': 1.0,
                        'lr': 0.0001,
                        'rl_ema': [0.0005, 5e-05],
                        'rl_epochs': 100,
                        'rl_final_lr': 1e-06,
                        'rl_lr': 0.0001,
                        'rl_start_lr': 2e-06,
                        'rl_warmup': 5,
                        'start_lr': 2e-06,
                        'warmup': 5,
                        'weight_decay': 0.04},
    'plateau': {   'patience': 10,
                   'rl_patience': 10,
                   'rl_threshold': 0.01,
                   'threshold': 0.01,
                   'wm_patience': 10,
                   'wm_threshold': 0.01},
    'redis': {   'host': '130.202.23.67',
                 'locker_expiration': 36000,
                 'password': 'your_strong_password',
                 'port': 6379}}
log_file  /persistence/agents/ag_00_04/jepa.csv
save_path  /persistence/agents/ag_00_04/jepa-ep{epoch}.pt
policy_latest_path  /persistence/agents/ag_00_04/jepa-policy_latest.pt
target_latest_path  /persistence/agents/ag_00_04/jepa-target_latest.pt
policy_load_path  /persistence/agents/ag_00_04/jepa-policy_latest.pt
target_load_path  /persistence/agents/ag_00_04/jepa-target_latest.pt
episodes keys  dict_keys(['state_sequence', 'position_sequence', 'reward_sequence', 'delta_reward_sequence', 'action_sequence'])
{   'action': {   'jump': {   'down': [0.0, -3.0, 0.0],
                              'left': [-5.0, 0.0, 0.0],
                              'right': [5.0, 0.0, 0.0],
                              'up': [0.0, 3.0, 0.0]},
                  'long': {   'down': [0.0, -1.0, 0.0],
                              'left': [-1.0, 0.0, 0.0],
                              'right': [1.0, 0.0, 0.0],
                              'up': [0.0, 1.0, 0.0],
                              'zoom_in': [0.0, 0.0, 0.2],
                              'zoom_out': [0.0, 0.0, -0.2]},
                  'noop': [0.0, 0.0, 0.0],
                  'short': {   'down': [0.0, -0.1, 0.0],
                               'left': [-0.1, 0.0, 0.0],
                               'left_down': [-0.1, -0.1, 0.0],
                               'left_up': [-0.1, 0.1, 0.0],
                               'right': [0.1, 0.0, 0.0],
                               'right_down': [0.1, -0.1, 0.0],
                               'right_up': [0.1, 0.1, 0.0],
                               'up': [0.0, 0.1, 0.0],
                               'zoom_in': [0.0, 0.0, 0.1],
                               'zoom_out': [0.0, 0.0, -0.1]}},
    'data': {   'batch_size': 4,
                'color_jitter_strength': 0.0,
                'crop_scale': [0.98, 1.0],
                'crop_size': 224,
                'global_batch_size': 32,
                'image_folder': 'imagenet_full_size/061417/',
                'num_workers': 10,
                'pin_mem': True,
                'rl_batch_size': 64,
                'root_path': '$replace_this_with_absolute_path_to_your_datasets_directory',
                'use_color_distortion': False,
                'use_gaussian_blur': False,
                'use_horizontal_flip': False},
    'deployment': {   'camera': {   'brand': 1,
                                    'ip': '130.202.23.91',
                                    'password': '0Bscura#',
                                    'username'Traceback (most recent call last):
  File "/app/main.py", line 250, in <module>
: 'camera'},
                      'distributed': {   'directory': '/home/waggle/world_models',
                                         'enabled': True,
                                         'ip': '130.202.23.67',
                                         'username': 'waggle'},
                      'docker': {   'app_path': '/home/waggle/dario/ptzjepa',
                                    'image': 'dariodematties/ptzjepa:latest',
                                    'log_path': '/home/waggle/dario/log.out',
                                    'persistence_path': '/home/waggle/dario/JEPA_Persistence'},
                      'operation': {   'debug': True,
                                       'iterations': 20,
                                       'keep_images': True,
                                       'movements': 20,
                                       'run_mode': 'lifelong',
                                       'track_all': True,
                                       'track_positions': True}},
    'dreamer': {'dream_length': 10, 'number_of_dreams': 20},
    'logging': {   'agent_folder': '/persistence/agents/',
                   'dream_folder': '/persistence/dreams/',
                   'folder': '/persistence/world_models/',
                   'ownership_folder': '/persistence',
                   'write_tag': 'jepa'},
    'mask': {   'allow_overlap': False,
                'aspect_ratio': [0.75, 1.5],
                'enc_mask_scale': [0.85, 1.0],
                'min_keep': 10,
                'num_enc_masks': 1,
                'num_pred_masks': 4,
                'patch_size': 14,
                'pred_mask_scale': [0.15, 0.2]},
    'memory': {'dreams': 50, 'memory_models': 10, 'models': 5, 'rl_models': 5},
    'meta': {   'agent_model_arch': 'vit_tiny',
                'camera_brand': 0,
                'copy_data': False,
                'distributed': True,
                'load_checkpoint': True,
                'model_arch': 'vit_tiny',
                'pred_depth': 12,
                'pred_emb_dim': 384,
                'read_checkpoint': None,
                'use_bfloat16': True},
    'optimization': {   'TAU': 0.0005,
                        'ema': [0.85, 1.0],
                        'epochs': 100,
                        'final_lr': 1e-06,
                        'final_weight_decay': 0.4,
                        'ipe_scale': 1.0,
                        'lr': 0.0001,
                        'rl_ema': [0.0005, 5e-05],
                        'rl_epochs': 100,
                        'rl_final_lr': 1e-06,
                        'rl_lr': 0.0001,
                        'rl_start_lr': 2e-06,
                        'rl_warmup': 5,
                        'start_lr': 2e-06,
                        'warmup': 5,
                        'weight_decay': 0.04},
    'plateau': {   'patience': 10,
                   'rl_patience': 10,
                   'rl_threshold': 0.01,
                   'threshold': 0.01,
                   'wm_patience': 10,
                   'wm_threshold': 0.01},
    'redis': {   'host': '130.202.23.67',
                 'locker_expiration': 36000,
                 'password': 'your_strong_password',
                 'port': 6379}}
    main()
  File "/app/main.py", line 238, in main
    lifelong_learning(args)
  File "/app/main.py", line 69, in lifelong_learning
    interaction_complete = env_inter(arguments, arguments.fname, "navigate_env")
  File "/app/source/env_interaction.py", line 494, in run
    return control_ptz(args, params)
  File "/app/source/env_interaction.py", line 193, in control_ptz
    world_model_name = restart_info["parent_model"]
KeyError: 'parent_model'
